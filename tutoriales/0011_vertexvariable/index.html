<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cómo aplicar transformaciones variables en un &lt;i&gt;vertex shader&lt;/i&gt;&lt;br/&gt;&lt;p class=&quot;author&quot;&gt;by Francisco Charte.&lt;/p&gt; - Torre de Babel</title>

<link href="data:text/css,pre%20%2Eoperator%2C%0Apre%20%2Eparen%20%7B%0A%20color%3A%20rgb%28104%2C%20118%2C%20135%29%0A%7D%0A%0Apre%20%2Eliteral%20%7B%0A%20color%3A%20%23990073%0A%7D%0A%0Apre%20%2Enumber%20%7B%0A%20color%3A%20%23099%3B%0A%7D%0A%0Apre%20%2Ecomment%20%7B%0A%20color%3A%20%23998%3B%0A%20font%2Dstyle%3A%20italic%0A%7D%0A%0Apre%20%2Ekeyword%20%7B%0A%20color%3A%20%23900%3B%0A%20font%2Dweight%3A%20bold%0A%7D%0A%0Apre%20%2Eidentifier%20%7B%0A%20color%3A%20rgb%280%2C%200%2C%200%29%3B%0A%7D%0A%0Apre%20%2Estring%20%7B%0A%20color%3A%20%23d14%3B%0A%7D%0A" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-148da7a2b8b9ad739a5a0b8b68683fed4ac7e50ce8185f17d86aa05e75ed376e.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Inconsolata|Source+Sans+Pro:400,400i,700" rel="stylesheet">
<link rel="stylesheet" href="http://fcharte.com/assets/css/monokai.css">

<link rel="stylesheet" href="http://fcharte.com/assets/css/numbersections.css">

<link rel="stylesheet" href="http://fcharte.com/assets/css/main.css">

  </head>
  <body class="layout-post">

    <header>
  <div class="inner header-inner">
    <a class="header-title" href="http://fcharte.com">Torre de Babel</a>
    <nav class="main-navigation">
  
  <a href="http://fcharte.com/about/">Sobre mí</a>
  
  <a href="http://fcharte.com/tutoriales/">Tutoriales</a>
  
  <a href="http://www.fcharte.com">Antiguo sitio web</a>
  
</nav>

  </div>
</header>

    <div class="main">
      <div class="inner main-inner">
        <h1>Cómo aplicar transformaciones variables en un <i>vertex shader</i><br/><p class="author">by Francisco Charte.</p></h1>

<article>
<ul class="section-nav">
</ul><p>Partiendo del código del VS del tutorial previo de esta serie, es fácil introducir algunos cambios a fin de que la transformación que se aplica a los vértices no sea constante sino variable con el tiempo. Para ello se puede utilizar el parámetro uniforme <code>time</code> (un parámetro al que tiene el acceso el <i>shader</i> y que no puede modificar, procede de la aplicación).</p>

<p>	El código del <i>shader</i>, una vez modificado, sería el siguiente:</p>
<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">uniform</span> <span class="kt">float</span> <span class="n">time</span><span class="p">;</span> <span class="c1">// Tiempo que lleva ejecutándose el shader
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">vec4</span> <span class="n">v</span> <span class="o">=</span> <span class="n">gl_Vertex</span><span class="p">;</span> <span class="c1">// Tomamos el vertice de origen
</span>
    <span class="c1">// Se aplica una transformación variable y periódica
</span>    <span class="n">v</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">abs</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Se aplica establece el vértice transformado como posición
</span>    <span class="n">gl_Position</span>    <span class="o">=</span> <span class="n">gl_ModelViewProjectionMatrix</span> <span class="o">*</span> <span class="n">v</span><span class="p">;</span>
    <span class="p">...</span></code></pre></figure>
<p>	La declaración <code>uniform float time</code> al inicio permite al <i>shader</i> acceder al citado parámetro <code>time</code>, en el que la aplicación facilita los segundos que lleva en ejecución. Este dato es suficiente para aplicar una transformación variable y de tipo periódico, gracias a las funciones <code>sin()</code> y <code>cos()</code>. Ambas son de tipo periódico, pero los valores negativos no interesan para este caso, por lo que se obtiene el valor absoluto.</p>

<p>	Al aplicar <code>sin()</code> sobre un eje y <code>cos()</code> sobre otro, lo que se consigue es que mientras la geometría crece en un uno de ellos decrezca en el otro y viceversa. El efecto, del que pueden verse dos capturas puntuales en la figura inferior, es que el cubo (o cualquier otra geometría que se cargue en el programa), se estira y encoge alternativamente en los ejes X e Y.</p>

<p style="text-align:center"><image src="http://www.fcharte.com/imagenes/vertex3.png" alt="Captura de dos instantes de la ejecución del VS"></image></p>

<p>	En lugar de aplicar un factor meramente multiplicativo a los ejes, que provoca un cambio de tamaño en la geometría, podrían realizar transformaciones de rotación variables en el tiempo, de forma que la escena vaya girando al completo en cualquiera de los ejes o en varios de ellos simultáneamente.</p>
</article>

      </div>
    </div>

    <footer>
  <div class="inner footer-inner">
    <div>
      &copy; 1997-2017 Francisco Charte.
      
      <nav class="main-navigation">
  
  <a href="https://www.researchgate.net/profile/F_Charte">ResearchGate</a>
  
  <a href="http://orcid.org/0000-0002-3083-8942">ORCID</a>
  
  <a href="https://github.com/fcharte">GitHub</a>
  
</nav>

      
    </div>
    <p>Contenido distribuido bajo <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.es">CC BY-NC-ND 4.0</a></p>
  </div>
</footer>


  </body>
</html>
